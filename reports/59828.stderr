=================================================================
==7==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7dc04a7bf921 at pc 0x000000646d60 bp 0x7ffce4852530 sp 0x7ffce4852528
READ of size 4 at 0x7dc04a7bf921 thread T0
SCARINESS: 32 (4-byte-read-stack-buffer-overflow)
    #0 0x646d5f in get_bits /src/ffmpeg/./libavcodec/get_bits.h:330:5
    #1 0x646d5f in get_bits_long /src/ffmpeg/./libavcodec/get_bits.h:417:16
    #2 0x646d5f in ff_jpegxl_verify_codestream_header /src/ffmpeg/libavformat/jpegxl_probe.c:383:13
    #3 0x63eaa9 in jpegxl_anim_read_header /src/ffmpeg/libavformat/jpegxl_anim_dec.c:189:14
    #4 0x5874bf in avformat_open_input /src/ffmpeg/libavformat/demux.c:313:20
    #5 0x4e8ca1 in LLVMFuzzerTestOneInput /src/ffmpeg/tools/target_dem_fuzzer.c:201:11
    #6 0xd307dd in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:255:7
    #7 0xd305e8 in LLVMFuzzerRunDriver /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c
    #8 0xd301a8 in main /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:300:10
    #9 0x7dc04acd0082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #10 0x4299ed in _start (/out/ffmpeg_dem_JPEGXL_ANIM_fuzzer+0x4299ed)

DEDUP_TOKEN: get_bits--get_bits_long--ff_jpegxl_verify_codestream_header
Address 0x7dc04a7bf921 is located in stack of thread T0 at offset 289 in frame
    #0 0x63e2ff in jpegxl_anim_read_header /src/ffmpeg/libavformat/jpegxl_anim_dec.c:136

DEDUP_TOKEN: jpegxl_anim_read_header
  This frame has 7 object(s):
    [32, 288) 'head' (line 141) <== Memory access at offset 289 overflows this variable
    [352, 356) 'copied' (line 165)
    [368, 4464) 'buf' (line 166)
    [4592, 4608) '.compoundliteral'
    [4624, 4640) '.compoundliteral109'
    [4656, 4672) '.compoundliteral119'
    [4688, 4704) '.compoundliteral126'
HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow /src/ffmpeg/./libavcodec/get_bits.h:330:5 in get_bits
Shadow bytes around the buggy address:
  0x0fb8894efed0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fb8894efee0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fb8894efef0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fb8894eff00: f1 f1 f1 f1 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fb8894eff10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0fb8894eff20: 00 00 00 00[f2]f2 f2 f2 f2 f2 f2 f2 f8 f2 f8 f8
  0x0fb8894eff30: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0fb8894eff40: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0fb8894eff50: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0fb8894eff60: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0fb8894eff70: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7==ABORTING
