INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2157480613
INFO: Loaded 1 modules   (174198 inline 8-bit counters): 174198 [0x1a75d00, 0x1aa0576), 
INFO: Loaded 1 PC tables (174198 PCs): 174198 [0x1aa0578,0x1d48cd8), 
/out/coder_PTIF_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==7==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7b3196ddba10 at pc 0x000000bb231e bp 0x7fff49ab1600 sp 0x7fff49ab15f8
WRITE of size 8 at 0x7b3196ddba10 thread T0
SCARINESS: 57 (8-byte-write-stack-buffer-overflow)
    #0 0xbb231d in _TIFFVGetField /src/libtiff/libtiff/tif_dir.c:1482:46
    #1 0xc9f851 in ZIPVGetField /src/libtiff/libtiff/tif_zip.c:644:20
    #2 0xc7fbae in PredictorVGetField /src/libtiff/libtiff/tif_predict.c:962:20
    #3 0xba116e in TIFFVGetField /src/libtiff/libtiff/tif_dir.c:1603:19
    #4 0xba116e in TIFFGetField /src/libtiff/libtiff/tif_dir.c:1588:14
    #5 0x990f0d in ReadTIFFImage /src/graphicsmagick/coders/tiff.c:2351:12
    #6 0x63c538 in ReadImage /src/graphicsmagick/magick/constitute.c:1682:13
    #7 0x5ec65b in BlobToImage /src/graphicsmagick/magick/blob.c:784:13
    #8 0x578cdc in Magick::Image::read(Magick::Blob const&) /src/graphicsmagick/Magick++/lib/Image.cpp:1592:5
    #9 0x56e909 in LLVMFuzzerTestOneInput /src/graphicsmagick/fuzzing/coder_fuzzer.cc:22:15
    #10 0x43fc53 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #11 0x42b3b2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #12 0x430c5c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #13 0x45a192 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #14 0x7b3197470082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #15 0x42157d in _start (/out/coder_PTIF_fuzzer+0x42157d)

DEDUP_TOKEN: _TIFFVGetField--ZIPVGetField--PredictorVGetField
Address 0x7b3196ddba10 is located in stack of thread T0 at offset 528 in frame
    #0 0x98d97f in ReadTIFFImage /src/graphicsmagick/coders/tiff.c:1803

DEDUP_TOKEN: ReadTIFFImage
  This frame has 51 object(s):
    [32, 34) 'bits_per_sample.i' (line 1211)
    [48, 50) 'photometric.i' (line 1211)
    [64, 72) 'blue_colormap.i' (line 1275)
    [96, 104) 'green_colormap.i' (line 1275)
    [128, 136) 'red_colormap.i' (line 1275)
    [160, 168) 'text' (line 1804)
    [192, 200) 'chromaticity' (line 1810)
    [224, 228) 'x_resolution' (line 1810)
    [240, 244) 'y_resolution' (line 1810)
    [256, 264) 'image' (line 1815)
    [288, 290) 'compress_tag' (line 1837)
    [304, 306) 'bits_per_sample' (line 1837)
    [320, 322) 'extra_samples' (line 1837)
    [336, 338) 'fill_order' (line 1837)
    [352, 354) 'max_sample_value' (line 1837)
    [368, 370) 'min_sample_value' (line 1837)
    [384, 386) 'orientation' (line 1837)
    [400, 402) 'pages' (line 1837)
    [416, 418) 'photometric' (line 1837)
    [432, 434) 'planar_config' (line 1837)
    [448, 456) 'sample_info' (line 1837)
    [480, 482) 'sample_format' (line 1837)
    [496, 498) 'samples_per_pixel' (line 1837)
    [512, 514) 'units' (line 1837)
    [528, 532) 'count' (line 1853) <== Memory access at offset 528 partially overflows this variable
    [544, 548) 'height' (line 1853)
    [560, 564) 'rows_per_strip' (line 1853)
    [576, 580) 'width' (line 1853)
    [592, 608) 'client_data' (line 1862)
    [624, 664) 'import_options' (line 1865)
    [704, 712) 'value' (line 1995)
    [736, 740) 'length' (line 2105)
    [752, 2805) 'alpha_string' (line 2280)
    [2944, 2946) 'pagenumber' (line 2307)
    [2960, 5013) '_attribute' (line 2349)
    [5152, 7205) '_attribute791' (line 2352)
    [7344, 9397) '_attribute825' (line 2355)
    [9536, 9540) 'quantum_samples' (line 2422)
    [9552, 9556) 'quantum_type' (line 2425)
    [9568, 9576) 'value1188' (line 2494)
    [9600, 9604) 'quantum_samples1229' (line 2529)
    [9616, 9620) 'quantum_type1230' (line 2537)
    [9632, 9636) 'quantum_samples1526' (line 2705)
    [9648, 9652) 'quantum_type1528' (line 2717)
    [9664, 9672) 'import_info' (line 2720)
    [9696, 9700) 'tile_columns' (line 2912)
    [9712, 9716) 'tile_rows' (line 2912)
    [9728, 9732) 'quantum_samples1855' (line 2921)
    [9744, 9748) 'quantum_type1857' (line 2926)
    [9760, 9764) 'tile_columns2677' (line 3299)
    [9776, 9780) 'tile_rows2678' (line 3299)
HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow /src/libtiff/libtiff/tif_dir.c:1482:46 in _TIFFVGetField
Shadow bytes around the buggy address:
  0x0f66b2db36f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0f66b2db3700: f1 f1 f1 f1 f8 f2 f8 f2 f8 f2 f2 f2 f8 f2 f2 f2
  0x0f66b2db3710: f8 f2 f2 f2 00 f2 f2 f2 00 f2 f2 f2 04 f2 04 f2
  0x0f66b2db3720: 00 f2 f2 f2 02 f2 02 f2 02 f2 02 f2 02 f2 02 f2
  0x0f66b2db3730: 02 f2 02 f2 02 f2 02 f2 00 f2 f2 f2 02 f2 02 f2
=>0x0f66b2db3740: 02 f2[04]f2 04 f2 04 f2 04 f2 00 00 f2 f2 00 00
  0x0f66b2db3750: 00 00 00 f2 f2 f2 f2 f2 f8 f2 f2 f2 f8 f2 f8 f8
  0x0f66b2db3760: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0f66b2db3770: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0f66b2db3780: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0f66b2db3790: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7==ABORTING
