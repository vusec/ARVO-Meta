INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 3285073052
INFO: Loaded 1 modules   (228574 inline 8-bit counters): 228574 [0x9d01620, 0x9d392fe),
INFO: Loaded 1 PC tables (228574 PCs): 228574 [0x9d39300,0x9ef79f0),
/out/coder_MSL_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
14:38:52 0:0.018326  0.020u 13 msl.c/MSLStartElement/4123/Option:
  Unrecognized element (u)
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xed203d7c at pc 0x0861f503 bp 0xff982a68 sp 0xff982a60
READ of size 4 at 0xed203d7c thread T0
SCARINESS: 17 (4-byte-read-heap-buffer-overflow)
    #0 0x861f502 in MSLEndElement /src/graphicsmagick/coders/msl.c:4162:59
    #1 0x88560d7 in xmlParseEndTag1 /src/libxml2/parser.c:8708:9
    #2 0x885d17e in xmlParseElementEnd /src/libxml2/parser.c:10152:2
    #3 0x8858ea9 in xmlParseContentInternal /src/libxml2/parser.c:9906:10
    #4 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #5 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #6 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #7 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #8 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #9 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #10 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #11 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #12 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #13 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #14 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #15 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #16 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #17 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #18 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #19 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #20 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #21 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #22 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #23 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #24 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #25 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #26 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #27 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #28 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #29 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #30 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #31 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #32 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #33 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #34 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #35 0x8858dc4 in xmlParseContentInternal /src/libxml2/parser.c:9918:6
    #36 0x884d955 in xmlParseContent /src/libxml2/parser.c:9953:5
    #37 0x884d955 in xmlParseBalancedChunkMemoryInternal /src/libxml2/parser.c:13397:5
    #38 0x8849a38 in xmlParseReference /src/libxml2/parser.c:7186:12
    #39 0x886ef04 in xmlParseTryOrFinish /src/libxml2/parser.c:11586:7
    #40 0x8867757 in xmlParseChunk /src/libxml2/parser.c
    #41 0x85fee63 in ProcessMSLScript /src/graphicsmagick/coders/msl.c:4621:14
    #42 0x85fd447 in ReadMSLImage /src/graphicsmagick/coders/msl.c:4758:10
    #43 0x8306cc9 in ReadImage /src/graphicsmagick/magick/constitute.c:1630:13
    #44 0x82b16ec in BlobToImage /src/graphicsmagick/magick/blob.c:764:13
    #45 0x821c458 in Magick::Image::read(Magick::Blob const&) /src/graphicsmagick/Magick++/lib/Image.cpp:1591:5
    #46 0x8210339 in LLVMFuzzerTestOneInput /src/graphicsmagick/fuzzing/coder_fuzzer.cc:22:15
    #47 0x80fa2ee in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #48 0x80e540e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #49 0x80eb12c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #50 0x8114657 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #51 0xf24a1ed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)
    #52 0x80c1985 in _start (/out/coder_MSL_fuzzer+0x80c1985)

DEDUP_TOKEN: MSLEndElement--xmlParseEndTag1--xmlParseElementEnd
0xed203d7c is located 4 bytes to the left of 256-byte region [0xed203d80,0xed203e80)
allocated by thread T0 here:
    #0 0x81cfb46 in __interceptor_realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:148:3
    #1 0x83ebae0 in _MagickReallocateResourceLimitedMemory /src/graphicsmagick/magick/memory.c:743:36
    #2 0x860be62 in MSLStartElement /src/graphicsmagick/coders/msl.c:1948:15
    #3 0x8854c52 in xmlParseStartTag /src/libxml2/parser.c
    #4 0x886cac7 in xmlParseTryOrFinish /src/libxml2/parser.c:11456:14
    #5 0x8867757 in xmlParseChunk /src/libxml2/parser.c
    #6 0x85fee63 in ProcessMSLScript /src/graphicsmagick/coders/msl.c:4621:14
    #7 0x85fd447 in ReadMSLImage /src/graphicsmagick/coders/msl.c:4758:10
    #8 0x8306cc9 in ReadImage /src/graphicsmagick/magick/constitute.c:1630:13
    #9 0x82b16ec in BlobToImage /src/graphicsmagick/magick/blob.c:764:13
    #10 0x821c458 in Magick::Image::read(Magick::Blob const&) /src/graphicsmagick/Magick++/lib/Image.cpp:1591:5
    #11 0x8210339 in LLVMFuzzerTestOneInput /src/graphicsmagick/fuzzing/coder_fuzzer.cc:22:15
    #12 0x80fa2ee in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #13 0x80e540e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #14 0x80eb12c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #15 0x8114657 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #16 0xf24a1ed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)

DEDUP_TOKEN: __interceptor_realloc--_MagickReallocateResourceLimitedMemory--MSLStartElement
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/graphicsmagick/coders/msl.c:4162:59 in MSLEndElement
Shadow bytes around the buggy address:
  0x3da40750: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3da40760: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3da40770: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3da40780: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3da40790: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x3da407a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[fa]
  0x3da407b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x3da407c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x3da407d0: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
  0x3da407e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x3da407f0: 00 fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING