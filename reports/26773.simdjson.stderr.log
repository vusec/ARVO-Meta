INFO: Seed: 3276432090
INFO: Loaded 1 modules   (4710 inline 8-bit counters): 4710 [0x8a9a88, 0x8aacee),
INFO: Loaded 1 PC tables (4710 PCs): 4710 [0x8aacf0,0x8bd350),
/out/fuzz_dump: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x748d1c89df4c at pc 0x00000055f9a0 bp 0x7fff78e87660 sp 0x7fff78e87658
READ of size 1 at 0x748d1c89df4c thread T0
SCARINESS: 27 (1-byte-read-stack-buffer-overflow)
    #0 0x55f99f in simdjson::internal::decimal_right_shift(simdjson::internal::decimal&, unsigned int) /src/simdjson/build/../src/from_chars.cpp:337:29
    #1 0x5ac6a8 in simdjson::internal::adjusted_mantissa simdjson::internal::compute_float<simdjson::internal::binary_format<double> >(simdjson::internal::decimal&) /src/simdjson/build/../src/from_chars.cpp:393:5
    #2 0x55fbb2 in simdjson::internal::adjusted_mantissa simdjson::internal::parse_long_mantissa<simdjson::internal::binary_format<double> >(char const*) /src/simdjson/build/../src/from_chars.cpp:468:10
    #3 0x55fa08 in simdjson::internal::from_chars(char const*) /src/simdjson/build/../src/from_chars.cpp:476:26
    #4 0x5addc5 in simdjson::westmere::(anonymous namespace)::numberparsing::parse_float_fallback(unsigned char const*, double*) /src/simdjson/build/../include/simdjson/generic/numberparsing.h:294:16
    #5 0x5adccc in simdjson::error_code simdjson::westmere::(anonymous namespace)::numberparsing::slow_float_parsing<simdjson::westmere::(anonymous namespace)::stage2::tape_writer>(unsigned char const*, simdjson::westmere::(anonymous namespace)::stage2::tape_writer) /src/simdjson/build/../include/simdjson/generic/numberparsing.h:323:7
    #6 0x5953a4 in simdjson::error_code simdjson::westmere::(anonymous namespace)::numberparsing::write_float<simdjson::westmere::(anonymous namespace)::stage2::tape_writer>(unsigned char const*, bool, unsigned long, unsigned char const*, int, long, simdjson::westmere::(anonymous namespace)::stage2::tape_writer&) /src/simdjson/build/../include/simdjson/generic/numberparsing.h:452:24
    #7 0x5953a4 in simdjson::error_code simdjson::westmere::(anonymous namespace)::numberparsing::parse_number<simdjson::westmere::(anonymous namespace)::stage2::tape_writer>(unsigned char const*, simdjson::westmere::(anonymous namespace)::stage2::tape_writer&) /src/simdjson/build/../include/simdjson/generic/numberparsing.h:546:5
    #8 0x5953a4 in simdjson::westmere::(anonymous namespace)::stage2::tape_builder::visit_number(simdjson::westmere::(anonymous namespace)::stage2::json_iterator&, unsigned char const*) /src/simdjson/build/../src/generic/stage2/tape_builder.h:163:10
    #9 0x5953a4 in simdjson::westmere::(anonymous namespace)::stage2::tape_builder::visit_root_number(simdjson::westmere::(anonymous namespace)::stage2::json_iterator&, unsigned char const*) /src/simdjson/build/../src/generic/stage2/tape_builder.h:184:22
    #10 0x5953a4 in simdjson::error_code simdjson::westmere::(anonymous namespace)::stage2::json_iterator::visit_root_primitive<simdjson::westmere::(anonymous namespace)::stage2::tape_builder>(simdjson::westmere::(anonymous namespace)::stage2::tape_builder&, unsigned char const*) /src/simdjson/build/../src/generic/stage2/json_iterator.h:291:22
    #11 0x5953a4 in simdjson::westmere::(anonymous namespace)::stage2::tape_builder::visit_root_primitive(simdjson::westmere::(anonymous namespace)::stage2::json_iterator&, unsigned char const*) /src/simdjson/build/../src/generic/stage2/tape_builder.h:97:15
    #12 0x5953a4 in simdjson::error_code simdjson::westmere::(anonymous namespace)::stage2::json_iterator::walk_document<false, simdjson::westmere::(anonymous namespace)::stage2::tape_builder>(simdjson::westmere::(anonymous namespace)::stage2::tape_builder&) /src/simdjson/build/../src/generic/stage2/json_iterator.h:140:16
    #13 0x5953a4 in simdjson::error_code simdjson::westmere::(anonymous namespace)::stage2::tape_builder::parse_document<false>(simdjson::westmere::dom_parser_implementation&, simdjson::dom::document&) /src/simdjson/build/../src/generic/stage2/tape_builder.h:93:15
    #14 0x5953a4 in simdjson::westmere::dom_parser_implementation::stage2(simdjson::dom::document&) /src/simdjson/build/../src/westmere/dom_parser_implementation.cpp:147:10
    #15 0x5a5bdb in simdjson::westmere::dom_parser_implementation::parse(unsigned char const*, unsigned long, simdjson::dom::document&) /src/simdjson/build/../src/westmere/dom_parser_implementation.cpp:157:10
    #16 0x5557f1 in simdjson::dom::parser::parse(unsigned char const*, unsigned long, bool) & /src/simdjson/build/../include/simdjson/dom/parser-inl.h:99:28
    #17 0x5552f7 in LLVMFuzzerTestOneInput /src/simdjson/build/../fuzz/fuzz_dump.cpp:53:23
    #18 0x459dc1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:595:15
    #19 0x444e92 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #20 0x44af4e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:852:9
    #21 0x472f32 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #22 0x748d1b81d83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #23 0x420168 in _start (/out/fuzz_dump+0x420168)

DEDUP_TOKEN: simdjson::internal::decimal_right_shift(simdjson::internal::decimal&, unsigned int)--simdjson::internal::adjusted_mantissa simdjson::internal::compute_float<simdjson::internal::binary_format<double> >(simdjson::internal::decimal&)--simdjson::internal::adjusted_mantissa simdjson::internal::parse_long_mantissa<simdjson::internal::binary_format<double> >(char const*)
Address 0x748d1c89df4c is located in stack of thread T0 at offset 844 in frame
    #0 0x55fa8f in simdjson::internal::adjusted_mantissa simdjson::internal::parse_long_mantissa<simdjson::internal::binary_format<double> >(char const*) /src/simdjson/build/../src/from_chars.cpp:466

DEDUP_TOKEN: simdjson::internal::adjusted_mantissa simdjson::internal::parse_long_mantissa<simdjson::internal::binary_format<double> >(char const*)
  This frame has 2 object(s):
    [32, 40) 'first.addr'
    [64, 844) 'd' (line 467) <== Memory access at offset 844 overflows this variable
HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow /src/simdjson/build/../src/from_chars.cpp:337:29 in simdjson::internal::decimal_right_shift(simdjson::internal::decimal&, unsigned int)
Shadow bytes around the buggy address:
  0x0e922390bb90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0e922390bba0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0e922390bbb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0e922390bbc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0e922390bbd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0e922390bbe0: 00 00 00 00 00 00 00 00 00[04]f3 f3 f3 f3 f3 f3
  0x0e922390bbf0: f3 f3 f3 f3 f3 f3 f3 f3 f3 f3 f3 f3 00 00 00 00
  0x0e922390bc00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0e922390bc10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0e922390bc20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0e922390bc30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING