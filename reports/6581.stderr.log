INFO: Seed: 1833678793
INFO: Loaded 1 modules   (26379 inline 8-bit counters): 26379 [0xd9ede8, 0xda54f3), 
INFO: Loaded 1 PC tables (26379 PCs): 26379 [0xa40b10,0xaa7bc0), 
/out/pkcs8: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==7==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x603000008f98 at pc 0x00000084f4da bp 0x7ffe18ca8a50 sp 0x7ffe18ca8a48
READ of size 8 at 0x603000008f98 thread T0
SCARINESS: 23 (8-byte-read-heap-buffer-overflow)
    #0 0x84f4d9 in Botan::bigint_monty_redc(unsigned long*, unsigned long const*, unsigned long, unsigned long, unsigned long*, unsigned long) /src/botan/src/lib/math/mp/mp_monty.cpp:62:17
    #1 0x813e7b in Botan::(anonymous namespace)::CurveGFp_Montgomery::curve_mul(Botan::BigInt&, Botan::BigInt const&, Botan::BigInt const&, std::__1::vector<unsigned long, Botan::secure_allocator<unsigned long> >&) const /src/botan/src/lib/pubkey/ec_group/curve_gfp.cpp:92:4
    #2 0x8138b9 in Botan::(anonymous namespace)::CurveGFp_Montgomery::to_curve_rep(Botan::BigInt&, std::__1::vector<unsigned long, Botan::secure_allocator<unsigned long> >&) const /src/botan/src/lib/pubkey/ec_group/curve_gfp.cpp:67:4
    #3 0x6bf4ce in Botan::PointGFp::PointGFp(Botan::CurveGFp const&, Botan::BigInt const&, Botan::BigInt const&) /src/botan/src/lib/pubkey/ec_group/point_gfp.cpp:42:12
    #4 0x6baedc in Botan::EC_Group_Data::EC_Group_Data(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:39:10
    #5 0x6bac4b in __compressed_pair_elem<const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &, 0, 1, 2, 3, 4, 5, 6, 7> /usr/local/bin/../include/c++/v1/memory:2151:9
    #6 0x6bac4b in __compressed_pair<std::__1::allocator<Botan::EC_Group_Data> &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &> /usr/local/bin/../include/c++/v1/memory:2253
    #7 0x6bac4b in __shared_ptr_emplace<const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &> /usr/local/bin/../include/c++/v1/memory:3666
    #8 0x6bac4b in std::__1::shared_ptr<Botan::EC_Group_Data> std::__1::shared_ptr<Botan::EC_Group_Data>::make_shared<Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&>(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /usr/local/bin/../include/c++/v1/memory:4325
    #9 0x6ba632 in make_shared<Botan::EC_Group_Data, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &> /usr/local/bin/../include/c++/v1/memory:4704:12
    #10 0x6ba632 in Botan::EC_Group_Data_Map::add_curve(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:202
    #11 0x6b8d74 in Botan::EC_Group_Data_Map::lookup_or_create(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:187:17
    #12 0x6b3ffe in Botan::EC_Group::BER_decode_EC_group(unsigned char const*, unsigned long) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:291:30
    #13 0x6b5e06 in Botan::EC_Group::EC_Group(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:366:13
    #14 0x6cabb6 in Botan::EC_PrivateKey::EC_PrivateKey(Botan::AlgorithmIdentifier const&, std::__1::vector<unsigned char, Botan::secure_allocator<unsigned char> > const&, bool) /src/botan/src/lib/pubkey/ecc_key/ecc_key.cpp:152:22
    #15 0x59250b in Botan::ECDSA_PrivateKey::ECDSA_PrivateKey(Botan::AlgorithmIdentifier const&, std::__1::vector<unsigned char, Botan::secure_allocator<unsigned char> > const&) /src/botan/build/include/botan/ecdsa.h:75:10
    #16 0x58db21 in Botan::load_private_key(Botan::AlgorithmIdentifier const&, std::__1::vector<unsigned char, Botan::secure_allocator<unsigned char> > const&) /src/botan/src/lib/pubkey/pk_algs.cpp:189:47
    #17 0x52e68a in Botan::PKCS8::(anonymous namespace)::load_key(Botan::DataSource&, std::__1::function<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > ()>, bool) /src/botan/src/lib/pubkey/pkcs8.cpp:333:11
    #18 0x52ee38 in Botan::PKCS8::load_key(Botan::DataSource&) /src/botan/src/lib/pubkey/pkcs8.cpp:365:11
    #19 0x52f62d in Botan::PKCS8::load_key(Botan::DataSource&, Botan::RandomNumberGenerator&) /src/botan/src/lib/pubkey/pkcs8.cpp:406:11
    #20 0x52a9a9 in fuzz(unsigned char const*, unsigned long) /src/botan/./src/fuzzer/pkcs8.cpp:18:47
    #21 0x52a88c in LLVMFuzzerTestOneInput /src/botan/./src/fuzzer/fuzzers.h:39:7
    #22 0x87b4b0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:517:13
    #23 0x859309 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:280:6
    #24 0x864b3a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:703:9
    #25 0x8589ac in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #26 0x7b6fc3e2d83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #27 0x426538 in _start (/out/pkcs8+0x426538)

DEDUP_TOKEN: Botan::bigint_monty_redc(unsigned long*, unsigned long const*, unsigned long, unsigned long, unsigned long*, unsigned long)--Botan::(anonymous namespace)::CurveGFp_Montgomery::curve_mul(Botan::BigInt&, Botan::BigInt const&, Botan::BigInt const&, std::__1::vector<unsigned long, Botan::secure_allocator<unsigned long> >&) const--Botan::(anonymous namespace)::CurveGFp_Montgomery::to_curve_rep(Botan::BigInt&, std::__1::vector<unsigned long, Botan::secure_allocator<unsigned long> >&) const
0x603000008f98 is located 0 bytes to the right of 24-byte region [0x603000008f80,0x603000008f98)
allocated by thread T0 here:
    #0 0x4eee30 in calloc /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:97
    #1 0x541342 in Botan::allocate_memory(unsigned long, unsigned long) /src/botan/src/lib/utils/mem_ops.cpp:23:16
    #2 0x575ce8 in allocate /usr/local/bin/../include/c++/v1/memory:1547:21
    #3 0x575ce8 in std::__1::vector<unsigned long, Botan::secure_allocator<unsigned long> >::allocate(unsigned long) /usr/local/bin/../include/c++/v1/vector:937
    #4 0x57b90f in _ZNSt3__16vectorImN5Botan16secure_allocatorImEEE6assignIPmEENS_9enable_ifIXaasr21__is_forward_iteratorIT_EE5valuesr16is_constructibleImNS_15iterator_traitsIS8_E9referenceEEE5valueEvE4typeES8_S8_ /usr/local/bin/../include/c++/v1/vector:1414:9
    #5 0x578749 in operator= /usr/local/bin/../include/c++/v1/vector:1359:9
    #6 0x578749 in Botan::BigInt::BigInt(Botan::BigInt const&) /src/botan/src/lib/math/bigint/bigint.cpp:50
    #7 0x6bf38c in Botan::PointGFp::PointGFp(Botan::CurveGFp const&, Botan::BigInt const&, Botan::BigInt const&) /src/botan/src/lib/pubkey/ec_group/point_gfp.cpp:32:4
    #8 0x6baedc in Botan::EC_Group_Data::EC_Group_Data(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:39:10
    #9 0x6bac4b in __compressed_pair_elem<const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &, 0, 1, 2, 3, 4, 5, 6, 7> /usr/local/bin/../include/c++/v1/memory:2151:9
    #10 0x6bac4b in __compressed_pair<std::__1::allocator<Botan::EC_Group_Data> &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &> /usr/local/bin/../include/c++/v1/memory:2253
    #11 0x6bac4b in __shared_ptr_emplace<const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &> /usr/local/bin/../include/c++/v1/memory:3666
    #12 0x6bac4b in std::__1::shared_ptr<Botan::EC_Group_Data> std::__1::shared_ptr<Botan::EC_Group_Data>::make_shared<Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&>(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /usr/local/bin/../include/c++/v1/memory:4325
    #13 0x6ba632 in make_shared<Botan::EC_Group_Data, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::BigInt &, const Botan::OID &> /usr/local/bin/../include/c++/v1/memory:4704:12
    #14 0x6ba632 in Botan::EC_Group_Data_Map::add_curve(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:202
    #15 0x6b8d74 in Botan::EC_Group_Data_Map::lookup_or_create(Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::BigInt const&, Botan::OID const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:187:17
    #16 0x6b3ffe in Botan::EC_Group::BER_decode_EC_group(unsigned char const*, unsigned long) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:291:30
    #17 0x6b5e06 in Botan::EC_Group::EC_Group(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const&) /src/botan/src/lib/pubkey/ec_group/ec_group.cpp:366:13
    #18 0x6cabb6 in Botan::EC_PrivateKey::EC_PrivateKey(Botan::AlgorithmIdentifier const&, std::__1::vector<unsigned char, Botan::secure_allocator<unsigned char> > const&, bool) /src/botan/src/lib/pubkey/ecc_key/ecc_key.cpp:152:22
    #19 0x59250b in Botan::ECDSA_PrivateKey::ECDSA_PrivateKey(Botan::AlgorithmIdentifier const&, std::__1::vector<unsigned char, Botan::secure_allocator<unsigned char> > const&) /src/botan/build/include/botan/ecdsa.h:75:10
    #20 0x58db21 in Botan::load_private_key(Botan::AlgorithmIdentifier const&, std::__1::vector<unsigned char, Botan::secure_allocator<unsigned char> > const&) /src/botan/src/lib/pubkey/pk_algs.cpp:189:47
    #21 0x52e68a in Botan::PKCS8::(anonymous namespace)::load_key(Botan::DataSource&, std::__1::function<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > ()>, bool) /src/botan/src/lib/pubkey/pkcs8.cpp:333:11
    #22 0x52ee38 in Botan::PKCS8::load_key(Botan::DataSource&) /src/botan/src/lib/pubkey/pkcs8.cpp:365:11
    #23 0x52f62d in Botan::PKCS8::load_key(Botan::DataSource&, Botan::RandomNumberGenerator&) /src/botan/src/lib/pubkey/pkcs8.cpp:406:11
    #24 0x52a9a9 in fuzz(unsigned char const*, unsigned long) /src/botan/./src/fuzzer/pkcs8.cpp:18:47
    #25 0x52a88c in LLVMFuzzerTestOneInput /src/botan/./src/fuzzer/fuzzers.h:39:7
    #26 0x87b4b0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:517:13
    #27 0x859309 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:280:6
    #28 0x864b3a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:703:9
    #29 0x8589ac in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #30 0x7b6fc3e2d83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: calloc--Botan::allocate_memory(unsigned long, unsigned long)--allocate
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/botan/src/lib/math/mp/mp_monty.cpp:62:17 in Botan::bigint_monty_redc(unsigned long*, unsigned long const*, unsigned long, unsigned long, unsigned long*, unsigned long)
Shadow bytes around the buggy address:
  0x0c067fff91a0: fa fa fd fd fd fd fa fa fd fd fd fd fa fa fd fd
  0x0c067fff91b0: fd fa fa fa fd fd fd fa fa fa fd fd fd fd fa fa
  0x0c067fff91c0: fd fd fd fa fa fa fd fd fd fd fa fa fd fd fd fd
  0x0c067fff91d0: fa fa fd fd fd fd fa fa 00 00 00 fa fa fa fd fd
  0x0c067fff91e0: fd fd fa fa fd fd fd fd fa fa 00 00 00 00 fa fa
=>0x0c067fff91f0: 00 00 00[fa]fa fa 00 00 00 fa fa fa fa fa fa fa
  0x0c067fff9200: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c067fff9210: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c067fff9220: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c067fff9230: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c067fff9240: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7==ABORTING
