INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 71054986
INFO: Loaded 1 modules   (73338 inline 8-bit counters): 73338 [0x1765848, 0x17776c2),
INFO: Loaded 1 PC tables (73338 PCs): 73338 [0x17776c8,0x1895e68),
/out/jpegsave_file_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x612000010260 at pc 0x000000a9e025 bp 0x712ec45fe3e0 sp 0x712ec45fe3d8
READ of size 2 at 0x612000010260 thread T4 (worker)
SCARINESS: 42 (2-byte-read-heap-use-after-free)
    #0 0xa9e024 in decompress_smooth_data /src/libjpeg-turbo/jdcoefct.c:594:23
    #1 0xac84ba in process_data_simple_main /src/libjpeg-turbo/jdmainct.c:300:10
    #2 0x9c2245 in jpeg_read_scanlines /src/libjpeg-turbo/jdapistd.c:287:3
    #3 0x77c21f in read_jpeg_generate /src/libvips/libvips/foreign/jpeg2vips.c:823:3
    #4 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #5 0x593449 in vips_region_prepare_to_generate /src/libvips/libvips/iofuncs/region.c:1718:6
    #6 0x592f22 in vips_region_prepare_to /src/libvips/libvips/iofuncs/region.c:1835:7
    #7 0x6edc41 in vips_tile_cache_gen /src/libvips/libvips/conversion/tilecache.c:681:14
    #8 0x6efe20 in vips_line_cache_gen /src/libvips/libvips/conversion/tilecache.c:910:10
    #9 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #10 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #11 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #12 0x6e4cd7 in vips_sequential_generate /src/libvips/libvips/conversion/sequential.c:167:6
    #13 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #14 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #15 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #16 0x6bf753 in vips_extract_area_gen /src/libvips/libvips/conversion/extract.c:124:6
    #17 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #18 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #19 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #20 0x56a3b8 in vips_image_write_gen /src/libvips/libvips/iofuncs/image.c:2592:6
    #21 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #22 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #23 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #24 0x76f638 in vips_foreign_load_generate /src/libvips/libvips/foreign/foreign.c:977:13
    #25 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #26 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #27 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #28 0x56a3b8 in vips_image_write_gen /src/libvips/libvips/iofuncs/image.c:2592:6
    #29 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #30 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #31 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #32 0x56a3b8 in vips_image_write_gen /src/libvips/libvips/iofuncs/image.c:2592:6
    #33 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #34 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #35 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #36 0x6b86a8 in vips_copy_gen /src/libvips/libvips/conversion/copy.c:139:6
    #37 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #38 0x593449 in vips_region_prepare_to_generate /src/libvips/libvips/iofuncs/region.c:1718:6
    #39 0x592f22 in vips_region_prepare_to /src/libvips/libvips/iofuncs/region.c:1835:7
    #40 0x5a5e00 in wbuffer_work_fn /src/libvips/libvips/iofuncs/sinkdisc.c:425:11
    #41 0x5b64e2 in vips_thread_work_unit /src/libvips/libvips/iofuncs/threadpool.c:682:6
    #42 0x5b5e31 in vips_thread_main_loop /src/libvips/libvips/iofuncs/threadpool.c:705:3
    #43 0x5b41c6 in vips_thread_run /src/libvips/libvips/iofuncs/threadpool.c:210:11
    #44 0xf4c89e in g_thread_proxy (/out/jpegsave_file_fuzzer+0xf4c89e)
    #45 0x712ecbae66b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)
    #46 0x712ecb1fa51c in clone (/lib/x86_64-linux-gnu/libc.so.6+0x10751c)

DEDUP_TOKEN: decompress_smooth_data--process_data_simple_main--jpeg_read_scanlines
0x612000010260 is located 32 bytes inside of 296-byte region [0x612000010240,0x612000010368)
freed by thread T4 (worker) here:
    #0 0x5240a2 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3
    #1 0x57e452 in vips_type_map /src/libvips/libvips/iofuncs/object.c:2784:2
    #2 0x57e581 in vips_class_map_all /src/libvips/libvips/iofuncs/object.c:2842:16
    #3 0x57e41b in vips_type_map /src/libvips/libvips/iofuncs/object.c:2783:12
    #4 0x57e581 in vips_class_map_all /src/libvips/libvips/iofuncs/object.c:2842:16
    #5 0x57e709 in vips_class_find /src/libvips/libvips/iofuncs/object.c:2900:10
    #6 0x57e8dc in vips_type_find /src/libvips/libvips/iofuncs/object.c:3002:17
    #7 0x5818f3 in vips_operation_new /src/libvips/libvips/iofuncs/operation.c:654:15
    #8 0x585669 in vips_call_by_name /src/libvips/libvips/iofuncs/operation.c:905:20
    #9 0x585941 in vips_call_split /src/libvips/libvips/iofuncs/operation.c:1024:11
    #10 0x6be56b in vips_extract_area /src/libvips/libvips/conversion/extract.c:274:11
    #11 0x77b811 in read_jpeg_image /src/libvips/libvips/foreign/jpeg2vips.c:875:3
    #12 0x779b63 in vips__jpeg_read /src/libvips/libvips/foreign/jpeg2vips.c:939:7
    #13 0x779494 in vips__jpeg_read_source /src/libvips/libvips/foreign/jpeg2vips.c:959:3
    #14 0x77d8a1 in vips_foreign_load_jpeg_load /src/libvips/libvips/foreign/jpegload.c:151:6
    #15 0x76f426 in vips_foreign_load_start /src/libvips/libvips/foreign/foreign.c:946:7
    #16 0x5893d1 in vips__region_start /src/libvips/libvips/iofuncs/region.c:235:31
    #17 0x59249a in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1587:13
    #18 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #19 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #20 0x56a3b8 in vips_image_write_gen /src/libvips/libvips/iofuncs/image.c:2592:6
    #21 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #22 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #23 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #24 0x56a3b8 in vips_image_write_gen /src/libvips/libvips/iofuncs/image.c:2592:6
    #25 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #26 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #27 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #28 0x6b86a8 in vips_copy_gen /src/libvips/libvips/conversion/copy.c:139:6
    #29 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6

DEDUP_TOKEN: free--vips_type_map--vips_class_map_all
previously allocated by thread T4 (worker) here:
    #0 0x52430d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3
    #1 0xf30fc8 in g_malloc (/out/jpegsave_file_fuzzer+0xf30fc8)
    #2 0x57e581 in vips_class_map_all /src/libvips/libvips/iofuncs/object.c:2842:16
    #3 0x57e41b in vips_type_map /src/libvips/libvips/iofuncs/object.c:2783:12
    #4 0x57e581 in vips_class_map_all /src/libvips/libvips/iofuncs/object.c:2842:16
    #5 0x57e709 in vips_class_find /src/libvips/libvips/iofuncs/object.c:2900:10
    #6 0x57e8dc in vips_type_find /src/libvips/libvips/iofuncs/object.c:3002:17
    #7 0x5818f3 in vips_operation_new /src/libvips/libvips/iofuncs/operation.c:654:15
    #8 0x585669 in vips_call_by_name /src/libvips/libvips/iofuncs/operation.c:905:20
    #9 0x585941 in vips_call_split /src/libvips/libvips/iofuncs/operation.c:1024:11
    #10 0x6be56b in vips_extract_area /src/libvips/libvips/conversion/extract.c:274:11
    #11 0x77b811 in read_jpeg_image /src/libvips/libvips/foreign/jpeg2vips.c:875:3
    #12 0x779b63 in vips__jpeg_read /src/libvips/libvips/foreign/jpeg2vips.c:939:7
    #13 0x779494 in vips__jpeg_read_source /src/libvips/libvips/foreign/jpeg2vips.c:959:3
    #14 0x77d8a1 in vips_foreign_load_jpeg_load /src/libvips/libvips/foreign/jpegload.c:151:6
    #15 0x76f426 in vips_foreign_load_start /src/libvips/libvips/foreign/foreign.c:946:7
    #16 0x5893d1 in vips__region_start /src/libvips/libvips/iofuncs/region.c:235:31
    #17 0x59249a in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1587:13
    #18 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #19 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #20 0x56a3b8 in vips_image_write_gen /src/libvips/libvips/iofuncs/image.c:2592:6
    #21 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #22 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #23 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #24 0x56a3b8 in vips_image_write_gen /src/libvips/libvips/iofuncs/image.c:2592:6
    #25 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6
    #26 0x58c3a9 in vips_region_fill /src/libvips/libvips/iofuncs/region.c:879:7
    #27 0x5921d8 in vips_region_prepare /src/libvips/libvips/iofuncs/region.c:1662:7
    #28 0x6b86a8 in vips_copy_gen /src/libvips/libvips/conversion/copy.c:139:6
    #29 0x592595 in vips_region_generate /src/libvips/libvips/iofuncs/region.c:1593:6

DEDUP_TOKEN: malloc--g_malloc--vips_class_map_all
Thread T4 (worker) created by T0 here:
    #0 0x50e68a in pthread_create /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:214:3
    #1 0xf640b6 in g_system_thread_new (/out/jpegsave_file_fuzzer+0xf640b6)

DEDUP_TOKEN: pthread_create--g_system_thread_new
SUMMARY: AddressSanitizer: heap-use-after-free /src/libjpeg-turbo/jdcoefct.c:594:23 in decompress_smooth_data
Shadow bytes around the buggy address:
  0x0c247fff9ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c247fffa000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 fa
  0x0c247fffa010: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
  0x0c247fffa020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c247fffa030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 fa
=>0x0c247fffa040: fa fa fa fa fa fa fa fa fd fd fd fd[fd]fd fd fd
  0x0c247fffa050: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c247fffa060: fd fd fd fd fd fd fd fd fd fd fd fd fd fa fa fa
  0x0c247fffa070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c247fffa080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c247fffa090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING