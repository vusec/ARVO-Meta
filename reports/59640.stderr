=================================================================
==7==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7a1dcb9bf922 at pc 0x0000006483ae bp 0x7fff13c59170 sp 0x7fff13c59168
READ of size 4 at 0x7a1dcb9bf922 thread T0
SCARINESS: 32 (4-byte-read-stack-buffer-overflow)
    #0 0x6483ad in get_bits /src/ffmpeg/./libavcodec/get_bits.h:330:5
    #1 0x6483ad in get_bits_long /src/ffmpeg/./libavcodec/get_bits.h:417:16
    #2 0x6483ad in jpegxl_read_extra_channel_info /src/ffmpeg/libavformat/jpegxl_probe.c:213:23
    #3 0x6483ad in ff_jpegxl_verify_codestream_header /src/ffmpeg/libavformat/jpegxl_probe.c:307:17
    #4 0x63eaa9 in jpegxl_anim_read_header /src/ffmpeg/libavformat/jpegxl_anim_dec.c:189:14
    #5 0x5874bf in avformat_open_input /src/ffmpeg/libavformat/demux.c:313:20
    #6 0x4e8ca1 in LLVMFuzzerTestOneInput /src/ffmpeg/tools/target_dem_fuzzer.c:201:11
    #7 0xd307dd in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:255:7
    #8 0xd305e8 in LLVMFuzzerRunDriver /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c
    #9 0xd301a8 in main /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:300:10
    #10 0x7a1dcbf6a082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #11 0x4299ed in _start (/out/ffmpeg_dem_JPEGXL_ANIM_fuzzer+0x4299ed)

DEDUP_TOKEN: get_bits--get_bits_long--jpegxl_read_extra_channel_info
Address 0x7a1dcb9bf922 is located in stack of thread T0 at offset 290 in frame
    #0 0x63e2ff in jpegxl_anim_read_header /src/ffmpeg/libavformat/jpegxl_anim_dec.c:136

DEDUP_TOKEN: jpegxl_anim_read_header
  This frame has 7 object(s):
    [32, 288) 'head' (line 141) <== Memory access at offset 290 overflows this variable
    [352, 356) 'copied' (line 165)
    [368, 4464) 'buf' (line 166)
    [4592, 4608) '.compoundliteral'
    [4624, 4640) '.compoundliteral109'
    [4656, 4672) '.compoundliteral119'
    [4688, 4704) '.compoundliteral126'
HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow /src/ffmpeg/./libavcodec/get_bits.h:330:5 in get_bits
Shadow bytes around the buggy address:
  0x0f443972fed0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0f443972fee0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0f443972fef0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0f443972ff00: f1 f1 f1 f1 00 00 00 00 00 00 00 00 00 00 00 00
  0x0f443972ff10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0f443972ff20: 00 00 00 00[f2]f2 f2 f2 f2 f2 f2 f2 f8 f2 f8 f8
  0x0f443972ff30: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0f443972ff40: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0f443972ff50: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0f443972ff60: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
  0x0f443972ff70: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7==ABORTING
