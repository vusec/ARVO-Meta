INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 3294102611
INFO: Loaded 1 modules   (8526 inline 8-bit counters): 8526 [0x70d068, 0x70f1b6),
INFO: Loaded 1 PC tables (8526 PCs): 8526 [0x70f1b8,0x730698),
/out/fuzzer_reencoder: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x76eab639fdf8 at pc 0x000000572284 bp 0x7ffecb89f9c0 sp 0x7ffecb89f9b8
WRITE of size 8 at 0x76eab639fdf8 thread T0
SCARINESS: 57 (8-byte-write-stack-buffer-overflow)
    #0 0x572283 in FLAC::Decoder::FuzzerDecoder::metadata_callback(FLAC__StreamMetadata const*) /src/flac/oss-fuzz/fuzzer_reencoder.cc:64:58
    #1 0x5868dc in FLAC::Decoder::Stream::metadata_callback_(FLAC__StreamDecoder const*, FLAC__StreamMetadata const*, void*) /src/flac/src/libFLAC++/stream_decoder.cpp:321:14
    #2 0x592423 in read_metadata_ /src/flac/src/libFLAC/stream_decoder.c:1504:5
    #3 0x59b2c7 in FLAC__stream_decoder_process_until_end_of_metadata /src/flac/src/libFLAC/stream_decoder.c:1028:9
    #4 0x586e1e in FLAC::Decoder::Stream::process_until_end_of_metadata() /src/flac/src/libFLAC++/stream_decoder.cpp:212:29
    #5 0x57066e in LLVMFuzzerTestOneInput /src/flac/oss-fuzz/fuzzer_reencoder.cc:212:21
    #6 0x43de83 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #7 0x4295e2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #8 0x42ee8c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #9 0x4583c2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #10 0x76eab694e082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #11 0x41f7ad in _start (/out/fuzzer_reencoder+0x41f7ad)

DEDUP_TOKEN: FLAC::Decoder::FuzzerDecoder::metadata_callback(FLAC__StreamMetadata const*)--FLAC::Decoder::Stream::metadata_callback_(FLAC__StreamDecoder const*, FLAC__StreamMetadata const*, void*)--read_metadata_
Address 0x76eab639fdf8 is located in stack of thread T0 at offset 1528 in frame
    #0 0x56ea9f in LLVMFuzzerTestOneInput /src/flac/oss-fuzz/fuzzer_reencoder.cc:126

DEDUP_TOKEN: LLVMFuzzerTestOneInput
  This frame has 22 object(s):
    [32, 56) 'v.i841'
    [96, 120) 'v.i820'
    [160, 184) 'v.i797'
    [224, 248) 'v.i776'
    [288, 312) 'v.i754'
    [352, 376) 'v.i732'
    [416, 440) 'v.i709'
    [480, 504) 'v.i686'
    [544, 568) 'v.i665'
    [608, 632) 'v.i643'
    [672, 696) 'v.i623'
    [736, 760) 'v.i602'
    [800, 824) 'v.i581'
    [864, 888) 'v.i561'
    [928, 952) 'v.i540'
    [992, 1016) 'v.i521'
    [1056, 1080) 'v.i502'
    [1120, 1144) 'v.i482'
    [1184, 1208) 'v.i'
    [1248, 1288) 'ds' (line 127)
    [1328, 1344) 'encoder' (line 128)
    [1360, 1528) 'decoder' (line 129) <== Memory access at offset 1528 overflows this variable
HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow /src/flac/oss-fuzz/fuzzer_reencoder.cc:64:58 in FLAC::Decoder::FuzzerDecoder::metadata_callback(FLAC__StreamMetadata const*)
Shadow bytes around the buggy address:
  0x0eddd6c6bf60: f2 f2 f2 f2 f8 f8 f8 f2 f2 f2 f2 f2 f8 f8 f8 f2
  0x0eddd6c6bf70: f2 f2 f2 f2 f8 f8 f8 f2 f2 f2 f2 f2 f8 f8 f8 f2
  0x0eddd6c6bf80: f2 f2 f2 f2 f8 f8 f8 f2 f2 f2 f2 f2 f8 f8 f8 f2
  0x0eddd6c6bf90: f2 f2 f2 f2 f8 f8 f8 f2 f2 f2 f2 f2 00 00 00 00
  0x0eddd6c6bfa0: 00 f2 f2 f2 f2 f2 00 00 f2 f2 00 00 00 00 00 00
=>0x0eddd6c6bfb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00[f3]
  0x0eddd6c6bfc0: f3 f3 f3 f3 f3 f3 f3 f3 00 00 00 00 00 00 00 00
  0x0eddd6c6bfd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0eddd6c6bfe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0eddd6c6bff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0eddd6c6c000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING