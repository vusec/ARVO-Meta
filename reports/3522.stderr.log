INFO: Seed: 1832196880
INFO: Loaded 1 modules   (3932 guards): 3932 [0x911b80, 0x9158f0), 
/out/block_round_trip: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==7==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62a000005ae8 at pc 0x0000004dd485 bp 0x7ffc1fa22e20 sp 0x7ffc1fa225d0
WRITE of size 1025 at 0x62a000005ae8 thread T0
SCARINESS: 45 (multi-byte-write-heap-buffer-overflow)
    #0 0x4dd484 in __asan_memcpy /src/llvm/projects/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cc:23
    #1 0x55ddee in ZSTD_storeLastLiterals /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:1570:5
    #2 0x55d611 in ZSTD_compressBlock_internal /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:1596:5
    #3 0x552d18 in ZSTD_compressContinue_internal /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:1792:30
    #4 0x553101 in ZSTD_compressBlock /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:1819:12
    #5 0x58a6c3 in roundTripTest /src/zstd/tests/fuzz/block_round_trip.c:42:11
    #6 0x58a1cb in LLVMFuzzerTestOneInput /src/zstd/tests/fuzz/block_round_trip.c:82:13
    #7 0x5ac720 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:463:13
    #8 0x58b335 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:273:6
    #9 0x596650 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:687:9
    #10 0x58a9d8 in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #11 0x7bd3f653983f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #12 0x41bff8 in _start (/out/block_round_trip+0x41bff8)

DEDUP_TOKEN: __asan_memcpy--ZSTD_storeLastLiterals--ZSTD_compressBlock_internal
0x62a000005ae8 is located 0 bytes to the right of 22760-byte region [0x62a000000200,0x62a000005ae8)
allocated by thread T0 here:
    #0 0x4de3c8 in malloc /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:88
    #1 0x5374c4 in ZSTD_malloc /src/zstd/tests/fuzz/../../lib/common/zstd_common.c:57:12
    #2 0x55a9bc in ZSTD_resetCCtx_internal /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:886:33
    #3 0x553640 in ZSTD_compressBegin_internal /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:2026:5
    #4 0x553306 in ZSTD_compressBegin_advanced_internal /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:2040:12
    #5 0x553987 in ZSTD_compressBegin_advanced /src/zstd/tests/fuzz/../../lib/compress/zstd_compress.c:2053:12
    #6 0x58a67b in roundTripTest /src/zstd/tests/fuzz/block_round_trip.c:39:18
    #7 0x58a1cb in LLVMFuzzerTestOneInput /src/zstd/tests/fuzz/block_round_trip.c:82:13
    #8 0x5ac720 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:463:13
    #9 0x58b335 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:273:6
    #10 0x596650 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:687:9
    #11 0x58a9d8 in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #12 0x7bd3f653983f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: malloc--ZSTD_malloc--ZSTD_resetCCtx_internal
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/llvm/projects/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cc:23 in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c547fff8b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c547fff8b10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c547fff8b20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c547fff8b30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c547fff8b40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c547fff8b50: 00 00 00 00 00 00 00 00 00 00 00 00 00[fa]fa fa
  0x0c547fff8b60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c547fff8b70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c547fff8b80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c547fff8b90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c547fff8ba0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7==ABORTING
